# Copyright 2025 Cisco Systems, Inc. and its affiliates
#
# SPDX-License-Identifier: Apache-2.0

---
benchmark:
  metadata: !from
    '$BENCHMARKS_ROOT/base-template.yaml["metadata"]':
      name: "athenabench-vsp"
      description: |-
        The AthenaBench Benchmark for Vulnerability Severity Prediction (VSP).
        Given a vulnerability description, this task requires the model to
        predict the severity of a vulnerability as
        a Common Vulnerability Scoring System (CVSS) vector string.
        This prediction is compared to the true CVSS vector string by using
        the CVSS scoring system.
      urls:
        - https://arxiv.org/abs/2511.01144
        - https://github.com/Athena-Software-Group/athenabench
      categories: ["security"]
      state: experimental
  source:
    git_repo: !from
      '$BENCHMARKS_ROOT/sources-template.yaml["sources"]["git_repo"]':
        repo_url: "https://github.com/Athena-Software-Group/athenabench.git"
        branch: "main"
        commit: "39d3a74eaf84b93e21dde0a4b60ddd4f08620eaf"
        type: "jsonl"
        benchmark_data_paths:
          - "benchmark/athena-cti-vsp.jsonl"
    options:
      dataframe_transform_expr: |
        df.assign(
            question=df["prompt"].str.strip(),
            answer=df["answer"].str.strip().str.upper(),
        )[["question", "answer"]]
  saqa_config:
    type: "domain_specific"
  format:
    # Currently no base/chat instruction is used for this benchmark as the
    # instruction is embedded in the prompt.
    instructions: !from '$BENCHMARKS_ROOT/instructions-template.yaml["instructions"]'
    prompt:
      question_template: "{{ question }}"
      answer_template: "Answer: {{ answer }}"
      prompt_template: !from '$BENCHMARKS_ROOT/prompting-template.yaml["prompting"]["prompt_template"]'
  output_processing: !from
    '$BENCHMARKS_ROOT/output-processing-template.yaml["output_processing"]':
      answer_formats:
        - pattern: '(?i)\banswer\s*:\s*(cvss:3\.\d(?:/\w+:\w+)+)\b'
          capture_transform:
            params: ["x"]
            expr: "x.strip().upper()"
          match_disambiguation: "match_if_unique"
          format_type: "proper"
        - pattern: '(?i)\b((?:/\w+:\w+){2,})\b'
          capture_transform:
            params: ["x"]
            expr: '"CVSS:3.0" + x.strip().upper()'
          match_disambiguation: "match_if_unique"
          format_type: "improper"
      score_fns:
        cvss_score:
          type: "cvss"
